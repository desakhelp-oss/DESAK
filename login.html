<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DESAK | Login</title>

<style>
    body {
        margin: 0;
        padding: 0;
        background: #111;
        color: #fff;
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }

    .login-container {
        background: #fff;
        color: #000;
        width: 95%;
        max-width: 420px;
        padding: 40px;
        border-radius: 18px;
        box-shadow: 0 0 30px rgba(0,0,0,0.4);
        animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to   { opacity: 1; transform: translateY(0); }
    }

    .title {
        font-size: 2rem;
        font-weight: 700;
        text-align: center;
        margin-bottom: 25px;
        letter-spacing: 1px;
    }

    input {
        width: 100%;
        padding: 12px;
        margin: 8px 0;
        border-radius: 8px;
        border: 1px solid #000;
        background: #f7f7f7;
        font-size: 1rem;
    }

    button {
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 8px;
        background: #000;
        color: #fff;
        font-size: 1rem;
        margin-top: 10px;
        cursor: pointer;
        transition: 0.3s;
    }
    button:hover { background: #333; }

    .divider {
        text-align: center;
        margin: 20px 0;
        font-size: 0.9rem;
        color: #555;
    }

    .social-btn {
        width: 100%;
        padding: 14px;
        border-radius: 8px;
        border: 1px solid #000;
        margin-top: 10px;
        background: #fff;
        color: #000;
        cursor: pointer;
        font-size: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: 0.3s;
    }
    .social-btn:hover {
        background: #f0f0f0;
    }

    .otp-section {
        display: none;
        margin-top: 15px;
    }

    .note {
        font-size: 0.8rem;
        text-align: center;
        margin-top: 10px;
        color: #444;
    }

    a { color: #000; }
</style>
</head>
<body>

<div class="login-container">
    <div class="title">Login to DESAK</div>

    <!-- EMAIL LOGIN -->
    <input id="email" type="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">
    <button id="emailLoginBtn">Login</button>

    <div class="divider">or continue with</div>

    <!-- GOOGLE -->
    <button class="social-btn" id="googleBtn">ðŸ”˜ Continue with Google</button>

    <!-- APPLE -->
    <button class="social-btn" id="appleBtn">ï£¿ Sign in with Apple</button>

    <!-- PHONE -->
    <button class="social-btn" id="phoneBtn">ðŸ“± Sign in with Phone</button>

    <div class="otp-section" id="otpBox">
        <input id="phoneInput" type="text" placeholder="Enter phone (+91...)">
        <button id="sendOtp">Send OTP</button>

        <input id="otpInput" type="text" placeholder="Enter OTP">
        <button id="verifyOtp">Verify OTP</button>

        <div id="recaptcha-container"></div>
    </div>

    <div class="note">
        Need an account? Sign up on the homepage popup.
    </div>

</div>


<!-- FIREBASE MODULE -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import {
        getAuth,
        GoogleAuthProvider,
        OAuthProvider,
        signInWithPopup,
        RecaptchaVerifier,
        signInWithPhoneNumber,
        signInWithEmailAndPassword
    } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyB-dvNv0l6kHu48Vi0GVrT6p5SbuZXvjV0",
        authDomain: "desak-e658f.firebaseapp.com",
        projectId: "desak-e658f",
        storageBucket: "desak-e658f.firebasestorage.app",
        messagingSenderId: "245836805162",
        appId: "1:245836805162:web:244353a8d42799176d7f53",
        measurementId: "G-DFW0HM8ZDW"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // -------------- EMAIL LOGIN ----------------
    document.getElementById("emailLoginBtn").onclick = async () => {
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();
        try {
            await signInWithEmailAndPassword(auth, email, password);
            alert("Logged in successfully!");
            window.location.href = "index.html";
        } catch (err) {
            alert(err.message);
        }
    };

    // -------------- GOOGLE LOGIN ----------------
    const googleProvider = new GoogleAuthProvider();
    document.getElementById("googleBtn").onclick = async () => {
        try {
            await signInWithPopup(auth, googleProvider);
            alert("Google login successful!");
            window.location.href = "index.html";
        } catch (err) {
            alert(err.message);
        }
    };

    // -------------- APPLE LOGIN ----------------
    const appleProvider = new OAuthProvider("apple.com");
    document.getElementById("appleBtn").onclick = async () => {
        try {
            await signInWithPopup(auth, appleProvider);
            alert("Apple login successful!");
            window.location.href = "index.html";
        } catch (err) {
            alert(err.message);
        }
    };

    // -------------- PHONE LOGIN ----------------
    const phoneBtn = document.getElementById("phoneBtn");
    const otpBox = document.getElementById("otpBox");

    phoneBtn.onclick = () => {
        otpBox.style.display = "block";
        renderRecaptcha();
    };

    const renderRecaptcha = () => {
        window.recaptchaVerifier = new RecaptchaVerifier(auth, "recaptcha-container", {
            size: "normal"
        });
    };

    let confirmationResult;

    document.getElementById("sendOtp").onclick = async () => {
        const number = document.getElementById("phoneInput").value.trim();
        try {
            confirmationResult = await signInWithPhoneNumber(auth, number, window.recaptchaVerifier);
            alert("OTP sent!");
        } catch (err) {
            alert(err.message);
        }
    };

    document.getElementById("verifyOtp").onclick = async () => {
        const otp = document.getElementById("otpInput").value.trim();
        try {
            await confirmationResult.confirm(otp);
            alert("Phone login successful!");
            window.location.href = "index.html";
        } catch (err) {
            alert(err.message);
        }
    };
</script>

</body>
</html>
